<!doctype html>
<html lang="en" itemscope itemtype="http://schema.org/Person">
<head>
  <meta charset="utf-8">
  <!-- Site Meta Data -->
  <title>Data Augmentation with Scikit-Image</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="Sara Massey">

  <!-- <link rel="shortcut icon" href=""> -->

  <!-- schema.org -->
  <meta itemprop="name" content="Sara Massey">
  <meta itemprop="image" content="">
  <meta itemprop="description" content="">

  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700' rel='stylesheet' type='text/css'>
  <!-- Style Meta Data -->
  <link rel="stylesheet" href="https://SMassey25.github.io/Understanding_Data/theme/css/style.css" type="text/css" />
  <link rel="stylesheet" href="https://SMassey25.github.io/Understanding_Data/theme/css/pygments.css" type="text/css" />

  <!-- Feed Meta Data -->
    <link href="https://SMassey25.github.io/Understanding_Data/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Sara Massey ATOM Feed" />

  <!-- Twitter Feed -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="">
  <meta name="twitter:image" content="">

<meta name="twitter:creator" content="">
<meta name="twitter:url" content="https://SMassey25.github.io/Understanding_Data/blog-4.html">
<meta name="twitter:title" content="Sara Massey ~ Data Augmentation with Scikit-Image">
<meta name="twitter:description" content="<p>According to the official site for scikit-image, "scikit-image is a collection of algorithms for image processing". As I learning about image processing, I seem to find more tutorials for OpenCV and Pillow rather than scikit-image, even though it comes pre-installed with several Python distributions. So here is my quick tutorial …</p>">

<!-- Facebook Meta Data -->
<meta property="og:title" content="Sara Massey ~ Data Augmentation with Scikit-Image" />
<meta property="og:description" content="<p>According to the official site for scikit-image, "scikit-image is a collection of algorithms for image processing". As I learning about image processing, I seem to find more tutorials for OpenCV and Pillow rather than scikit-image, even though it comes pre-installed with several Python distributions. So here is my quick tutorial …</p>" />
<meta property="og:image" content="" />
</head>

<body>
  <!-- Sidebar -->
  <aside>
    <!--<center><a href="https://SMassey25.github.io/Understanding_Data"><img id="avatar" src=""></a></center>-->
    <h1>Sara Massey</h1>
      <p>Aspiring Data Scientist Here</p>
    <br>


    <nav class="nav">
      <ul class="list-bare">

          <li><a class="nav__link" href="https://SMassey25.github.io/Understanding_Data">Blog</a></li>


      </ul>
    </nav>

    <p class="social">
        <a href="https://www.linkedin.com/in/saramassey25" target="_blank" ><img src="https://SMassey25.github.io/Understanding_Data/theme/images/icons/linkedin.png"></a>
        <a href="https://github.com/username" target="_blank" ><img src="https://SMassey25.github.io/Understanding_Data/theme/images/icons/github.png"></a>
      <a href="https://SMassey25.github.io/Understanding_Data/feeds/all.atom.xml" rel="alternate">
        <img src="https://SMassey25.github.io/Understanding_Data/theme/images/icons/rss.png"></a>
    </p>

    <!--
    <h2>Categories</h2>
    <ul class="navbar">
      <li class="active"><a href="https://SMassey25.github.io/Understanding_Data/category/misc.html">misc</a></li>
    </ul>
    -->
  </aside>

  <!-- Content -->
  <article>
<section id="content">
    <article>
        <h2 class="post_title post_detail"><a href="https://SMassey25.github.io/Understanding_Data/blog-4.html" rel="bookmark" title="Permalink to Data Augmentation with Scikit-Image">Data Augmentation with Scikit-Image</a></h2>
        <div class="entry-content blog-post">
            <p>According to the official site for scikit-image, "scikit-image is a collection of algorithms for image processing". As I learning about image processing, I seem to find more tutorials for OpenCV and Pillow rather than scikit-image, even though it comes pre-installed with several Python distributions. So here is my quick tutorial that might help you get started.</p>
<p>I will present basic operations, such as reading multiple pictures, converting them to gray scale, resizing and transforming the pictures as I work towards my image classification problem. I am following same format as <a href="https://vishalsharma01.github.io/Blog/blog-5.html">Pillow's blog</a> so that you can compare the two image processing libraries for yourself.</p>
<h3>Loading the Image</h3>
<p>Let's get started. We first load the image, using the imread routine from scikit-image.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>

<span class="kn">from</span> <span class="nn">skimage.io</span> <span class="kn">import</span> <span class="n">imshow</span><span class="p">,</span><span class="n">imread</span><span class="p">,</span><span class="n">imsave</span><span class="p">,</span> <span class="n">ImageCollection</span>
<span class="kn">from</span> <span class="nn">skimage.color</span> <span class="kn">import</span> <span class="n">rgb2gray</span>
<span class="kn">from</span> <span class="nn">skimage.transform</span> <span class="kn">import</span> <span class="n">rescale</span><span class="p">,</span> <span class="n">resize</span><span class="p">,</span> <span class="n">rotate</span>
<span class="kn">from</span> <span class="nn">skimage.util</span> <span class="kn">import</span> <span class="n">random_noise</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
</pre></div>


<p>Now that we have imported io from skimage, we can use absolute path to read a file. Scikit image's package, <em>imread</em>, is used to read an image as an array. YES, you read it correct, AS AN ARRAY. You might be wondering, why is this exciting? This means we manipulate the picture using other libraries in the Python Ecosystem, such as matplotlib and scipy. For example, you can see in the code below, you will see that the images are being displayed using the matplotlib.</p>
<div class="highlight"><pre><span></span><span class="n">directory</span> <span class="o">=</span> <span class="s1">&#39;C:/Users/m_mas/Desktop/skit-image/&#39;</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">directory</span> <span class="o">+</span><span class="s1">&#39;img_processing1.JPG&#39;</span><span class="p">)</span>
<span class="n">grayscale</span> <span class="o">=</span> <span class="n">rgb2gray</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Original image&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">grayscale</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;GrayScale&quot;</span><span class="p">)</span>


<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">550</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">550</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>


<p><img alt="png" src="output_5_0.png"></p>
<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="s2">&quot;Original Shape: &quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Gray Scaled Shape: &quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">grayscale</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span>Original Shape: (492, 538, 3)
Gray Scaled Shape: (492, 538)
</pre></div>


<h4>Different Types and their meanings</h4>
<p>The shape of the images tells us a lot. The third value in the shape of the original image indicates that the picture is a colored image rather than a gray scale. See below the table below for more combinations of shape you might encounter.</p>
<table>
<thead>
<tr>
<th>Image Types</th>
<th align="center">Coordinates</th>
</tr>
</thead>
<tbody>
<tr>
<td>2D Grayscale</td>
<td align="center">(row,columns)</td>
</tr>
<tr>
<td>2D Multichannel</td>
<td align="center">(row,columns,channel)</td>
</tr>
<tr>
<td>3D Grayscale</td>
<td align="center">(plane, row,columns)</td>
</tr>
<tr>
<td>3D Multichannel</td>
<td align="center">(plane,row,columns,channel)</td>
</tr>
</tbody>
</table>
<h2>Data Augmentation - Trick to multiplying your data</h2>
<p>To perform well on an image classifier you would need a lot of images to train. Web scrapping will get you started however you can drastically change the performance of your classifier by making an exhaustive dataset. Image data augmentation can be used to expand the size of our dataset by creating modified versions of the images in the existing dataset. You can scale(rescale/resize), flip(flipud/flipur), rotate or adding gaussian noise to get more of your limited dataset.</p>
<p><img alt="more_data1.jpg" src="images\more_data1.jpg"></p>
<h3>Rescalling and Resizing</h3>
<p>Rescaling and resizing are helpful tools that could be used for processing images. Rescaling shrinks an image by a given factor. In the example before, the scaling factor is 0.25 and the image size of 492 X 538 will be reduced to 142 X125. The scaling factor can be a either a floating point or a tuple containing value for each axis.</p>
<p>On a similar note, resizing let's you specify the shape of the image. In the example below our original image (492, 538) with be shaped to 200 X 200 pixels.</p>
<div class="highlight"><pre><span></span><span class="n">image_rescaled</span> <span class="o">=</span> <span class="n">rescale</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">anti_aliasing</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Shape after rescalling : &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">image_rescaled</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="n">image_resized</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="n">img</span><span class="p">,(</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span><span class="n">anti_aliasing</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c1"># print(&quot;Shape after resizing : &quot;+str(image_resized.shape))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Original image&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image_rescaled</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Rescaled image&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image_resized</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Resized image&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">550</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">550</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>


<div class="highlight"><pre><span></span>Shape after rescalling : (123, 134, 3)
</pre></div>


<p><img alt="png" src="images\output_11_1.png"></p>
<h2>Transforming / Altering the images</h2>
<h3>Flipping Images</h3>
<p>As the images are imported as an array, you can use numpy methods to flip images horizontally(fliplr) and vertically(flipud). However in the code below, I flipped the horizontally flipped image vertically to get a third type of flip. Too wordy right? Try to understand the code below, and I am sure you would get it.</p>
<div class="highlight"><pre><span></span><span class="n">image_resized</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="n">img</span><span class="p">,(</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span> <span class="n">anti_aliasing</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># Image tansformations</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">rgb2gray</span><span class="p">(</span><span class="n">image_resized</span><span class="p">)</span>
<span class="n">ud_img</span> <span class="o">=</span> <span class="n">rgb2gray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">img</span><span class="p">))</span>
<span class="n">lr_img</span> <span class="o">=</span> <span class="n">rgb2gray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fliplr</span><span class="p">(</span><span class="n">ud_img</span><span class="p">))</span>
<span class="n">fourth_img</span> <span class="o">=</span> <span class="n">rgb2gray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">lr_img</span><span class="p">))</span>

<span class="c1">#The above code is just for plotting the images</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Original image&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ud_img</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Flipped - Upside Down&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">lr_img</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Flipped - Left to Right&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">fourth_img</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Flipped&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<p><img alt="png" src="images\output_14_0.png"></p>
<h5>Rotating with Random integer</h5>
<p>In the code below, we will be randomly generating a number between -40 and 40 and then will be using the number to rotate the image.</p>
<div class="highlight"><pre><span></span><span class="n">img</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">directory</span> <span class="o">+</span><span class="s1">&#39;img_processing3.png&#39;</span><span class="p">)</span>
<span class="n">rand_dregree</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span><span class="mi">40</span><span class="p">)</span>
<span class="n">rotated</span> <span class="o">=</span> <span class="n">rotate</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">rand_dregree</span><span class="p">)</span>
<span class="n">rotated</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="n">rotated</span><span class="p">,(</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span><span class="n">anti_aliasing</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">imshow</span><span class="p">(</span><span class="n">rotated</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x1d79dea02e8&gt;
</pre></div>


<p><img alt="png" src="images\output_16_1.png"></p>
<div class="highlight"><pre><span></span><span class="n">img</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">directory</span> <span class="o">+</span><span class="s1">&#39;img_processing4.png&#39;</span><span class="p">)</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span><span class="n">img</span><span class="p">,(</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span><span class="n">anti_aliasing</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">gaussian_img</span> <span class="o">=</span> <span class="n">random_noise</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;gaussian&#39;</span><span class="p">)</span>
<span class="n">salt_img</span> <span class="o">=</span> <span class="n">random_noise</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;salt&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Original image&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">gaussian_img</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Noise added by Gaussian&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">salt_img</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Noise added by Salt&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>


<p><img alt="png" src="images\output_17_0.png"></p>
<h4>Saving the transformed images</h4>
<p>You can import imsave from io to save the new files on your computer. Imsave saves the new file on the same file level from where you are running the script. This method use two parameters, new file name as fname and the file you want to save as arr. 'fname' also let's you change the format of the file. For instance, you can save a jpg file as png file or vice versa just by changing the name of the file.</p>
<p>Note: The picture imported below is a jpg and we would change the format to png.</p>
<div class="highlight"><pre><span></span><span class="n">img</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">directory</span> <span class="o">+</span><span class="s1">&#39;img_processing4.png&#39;</span><span class="p">)</span>
<span class="n">output_directory</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">+</span> <span class="s1">&#39;editted&#39;</span><span class="o">+</span><span class="s1">&#39;/&#39;</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">imsave</span><span class="p">(</span><span class="n">output_directory</span><span class="o">+</span><span class="s1">&#39;edit.png&#39;</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span>
</pre></div>


<p><img alt="editted_image.JPG" src="images\editted_image.JPG"></p>
<h2>Making Changes to all the pictures</h2>
<p>You can certainly make a loop to get the name of the files and load then to make the changes. However, Scikit-image provides your a feature called <em>Image Collection</em> that let's you load all the images in the memory in one go. Image Collection takes a wild card as it's parameters. To begin with, let me show you a simple for loop to load the images and then I can show you how image collection can do the same job in one line.</p>
<h5>For Loop to load the images.</h5>
<div class="highlight"><pre><span></span><span class="n">files</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">def</span> <span class="nf">get_files</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
    <span class="k">for</span> <span class="nb">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">file</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;img_&quot;</span><span class="p">):</span>
            <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">file</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">files</span>

<span class="n">files_name</span> <span class="o">=</span> <span class="n">get_files</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
<span class="n">files_name</span>
</pre></div>


<div class="highlight"><pre><span></span>[&#39;img_processing1.JPG&#39;,
 &#39;img_processing2.jpg&#39;,
 &#39;img_processing3.png&#39;,
 &#39;img_processing4.png&#39;]
</pre></div>


<h5>Image Collection to load the images.</h5>
<div class="highlight"><pre><span></span><span class="n">ic</span> <span class="o">=</span> <span class="n">ImageCollection</span><span class="p">(</span><span class="s1">&#39;C:/Users/m_mas/Desktop/skit-image/*.*&#39;</span><span class="p">)</span>
<span class="n">ic</span><span class="o">.</span><span class="n">files</span>
</pre></div>


<div class="highlight"><pre><span></span>[&#39;C:/Users/m_mas/Desktop/skit-image\\img_processing1.JPG&#39;,
 &#39;C:/Users/m_mas/Desktop/skit-image\\img_processing2.jpg&#39;,
 &#39;C:/Users/m_mas/Desktop/skit-image\\img_processing3.png&#39;,
 &#39;C:/Users/m_mas/Desktop/skit-image\\img_processing4.png&#39;]
</pre></div>


<p>In the code below, I will be using all the transformation I used above and implement all of them on the four images I had in my folder. I will be changing the images in my folder to gray scale, adding random noise, rotating them by a certain degree and flipping them. All in all, I started with a dataset of 4 pictures and ended with 24 images that can be fed to a machine learning algorithm.</p>
<div class="highlight"><pre><span></span><span class="c1">#Changes all of then to gray scale</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">(</span><span class="n">feature_range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.99</span><span class="p">,</span><span class="mf">0.99</span><span class="p">))</span>

<span class="k">for</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">files_name</span><span class="p">:</span>
    <span class="nb">file</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[a-z]+_[a-z]+\d&#39;</span><span class="p">,</span><span class="n">files</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1">#Reads a files</span>
    <span class="n">temp_img</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">directory</span> <span class="o">+</span> <span class="n">files</span><span class="p">)</span>

    <span class="c1">#Changes to gray scale and resizes the image to 200*200</span>
    <span class="n">temp_gray</span> <span class="o">=</span> <span class="n">rgb2gray</span><span class="p">(</span><span class="n">temp_img</span><span class="p">)</span>
    <span class="n">img</span> <span class="o">=</span> <span class="p">(</span><span class="n">resize</span><span class="p">(</span><span class="n">temp_gray</span><span class="p">,(</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span><span class="n">anti_aliasing</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
    <span class="n">imsave</span><span class="p">(</span><span class="n">output_directory</span><span class="o">+</span><span class="nb">file</span><span class="o">+</span><span class="s1">&#39;1.jpg&#39;</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span>

    <span class="c1">#Random Noise</span>
    <span class="n">salt_noise</span> <span class="o">=</span> <span class="n">random_noise</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;salt&#39;</span><span class="p">)</span>
    <span class="n">salt_img</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">salt_noise</span><span class="p">)</span>
    <span class="n">imsave</span><span class="p">(</span><span class="n">output_directory</span><span class="o">+</span><span class="nb">file</span><span class="o">+</span><span class="s1">&#39;2.jpg&#39;</span><span class="p">,</span> <span class="n">salt_img</span><span class="p">)</span>

    <span class="c1">#Rotating the image and saving the file</span>
    <span class="n">rand_dregree</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span><span class="mi">25</span><span class="p">)</span>
    <span class="n">temp_rotate</span> <span class="o">=</span> <span class="n">rotate</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">rand_dregree</span><span class="p">)</span>
    <span class="n">imsave</span><span class="p">(</span><span class="n">output_directory</span><span class="o">+</span><span class="nb">file</span><span class="o">+</span><span class="s1">&#39;3.png&#39;</span><span class="p">,</span> <span class="n">temp_rotate</span><span class="p">)</span>

    <span class="c1">#Flipud - Veritcal Flip</span>
    <span class="n">vert_flip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
    <span class="n">imsave</span><span class="p">(</span><span class="n">output_directory</span><span class="o">+</span><span class="nb">file</span><span class="o">+</span><span class="s1">&#39;4.png&#39;</span><span class="p">,</span> <span class="n">vert_flip</span><span class="p">)</span>

    <span class="c1">#Flipur - Horizontal Flip</span>
    <span class="n">hori_flip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fliplr</span><span class="p">(</span><span class="n">vert_flip</span><span class="p">)</span>
    <span class="n">imsave</span><span class="p">(</span><span class="n">output_directory</span><span class="o">+</span><span class="nb">file</span><span class="o">+</span><span class="s1">&#39;5.png&#39;</span><span class="p">,</span> <span class="n">hori_flip</span><span class="p">)</span>

    <span class="c1">#Flipud - Vertically Flipping the hoziontally flipped image</span>
    <span class="n">vert_hori_flip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">hori_flip</span><span class="p">)</span>
    <span class="n">imsave</span><span class="p">(</span><span class="n">output_directory</span><span class="o">+</span><span class="nb">file</span><span class="o">+</span><span class="s1">&#39;6.png&#39;</span><span class="p">,</span> <span class="n">vert_hori_flip</span><span class="p">)</span>
</pre></div>


<p>All in all, Scikit image is good package to start data augmentation to expand your dataset. You can surely use different combinations to increase your dataset even more. For instance, add different type of noise on a rotated images.</p>
<p><img alt="possibilities.jpg" src="images\possibilities.jpg"></p>
        </div>
        <div class="post_list">
            <span>By </span>
            <a href="https://SMassey25.github.io/Understanding_Data/author/sara-massey.html">@Sara Massey</a>
            <span> in </span>
            <span class="post_category"><a href="https://SMassey25.github.io/Understanding_Data/category/misc.html" rel="bookmark" title="Permalink to misc">[ misc ]</a></span>
            <span class="post_date">Tue 06 August 2019</span>
            <div><span>Tags : </span>
                <span><a href="https://SMassey25.github.io/Understanding_Data/tag/python.html">#python, </a></span>
            </div>

            <div class="entry-social">
                <span class="twitter"><a target="_blank" rel="nofollow" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=400,width=700');return false;" title="Twitter" href="https://twitter.com/share?url=https://SMassey25.github.io/Understanding_Data/blog-4.html&text=Data Augmentation with Scikit-Image&via="><img src="https://SMassey25.github.io/Understanding_Data/theme/images/icons/twitter-s.png"></a></span>

                <span class="gplus"><a target="_blank" title="Google +" href="https://plus.google.com/share?url=https://SMassey25.github.io/Understanding_Data/blog-4.html&hl=fr" rel="nofollow" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=650');return false;"><img src="https://SMassey25.github.io/Understanding_Data/theme/images/icons/google-s.png"></a></span>

                <span class="facebook"><a target="_blank" title="Facebook" rel="nofollow" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=500,width=700');return false;" href="https://www.facebook.com/sharer.php?u=https://SMassey25.github.io/Understanding_Data/blog-4.html&t=Data Augmentation with Scikit-Image"><img src="https://SMassey25.github.io/Understanding_Data/theme/images/icons/facebook-s.png"></a></span>

                <a  target="_blank" title="Linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https://SMassey25.github.io/Understanding_Data/blog-4.html&title=Data Augmentation with Scikit-Image" rel="nofollow" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=650');return false;"><img src="https://SMassey25.github.io/Understanding_Data/theme/images/icons/linkedin-s.png"></a>

                <span class="mail"><a href="mailto:?subject=Data Augmentation with Scikit-Image&amp;body=Viens découvrir un article à propos de [Data Augmentation with Scikit-Image] sur le site de Sara Massey. https://SMassey25.github.io/Understanding_Data/blog-4.html" title="Share by Email" target="_blank"><img src="https://SMassey25.github.io/Understanding_Data/theme/images/icons/mail-s.png"></a></span>
            </div>
        </div>
    </article>
</section>
  </article>

  <!-- Footer -->
  <footer>
    <p>
      Copyright © Sara Massey 2019
    </p>
  </footer>


</body>
</html>